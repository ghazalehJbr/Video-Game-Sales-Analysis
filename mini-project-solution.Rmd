---
title: "CS555-Term-Project"
author: "Ghazaleh Jabbariarfaei"
output: pdf_document
fontsize: 12pt
header-includes :
  \usepackage[dvipsnames]{xcolor}

---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

```

## \textcolor{blue}{Research Scenario Description}  

We all heard the names of some of the most popular games in the world, such as FIFA, Minecraft, Heavy Rain, And there are some games which is less heard of. I would like to examine what makes these games so popular. Which genre is more popular and does this effect the global success of the game ? Is it just the genre or there are other factors defining a game success ? To carry out my project, I choose a videogames sales data set with a global sale column and a genre column.

Let's start by taking a closer look at our data set.


## \textcolor{blue}{Data set: Video Game sales}  

The data set is a list of video games with sales greater than 100,000 copies.
The original data set can be found \href{https://www.kaggle.com/gregorut/videogamesales}{\textcolor{cyan}{here}}.
There were originally eleven columns and 16598 observation in the data set,however, for the sake of this project I did remove some columns and reduce the size of my data to show observations for 2 years : 2016, 2017.  

```{r, echo=FALSE,include=TRUE}
setwd("~/Desktop/Uni Courses/Spring 2020/CS555/Term Project")
data <- read.csv("vgsales.csv")
data1 <- subset(data, data$Year == 2016 | data$Year == 2017, -c(1,7,8,10,9))
data1 <- data1[-c(which(data1$Publisher == "N/A" | data1$Publisher == "Unknown")),]
write.table(data1, file = "data.csv",sep = "\t", row.names = F)
```

The column names are  


```{r, echo=FALSE}
colnames(data1)
```

* \textcolor{Plum}{Name} is the name of the games
* \textcolor{Plum}{Platform} is the platform of the games released (i.e. PC,PS4, etc.)
* \textcolor{Plum}{Year} is the year the game was released (I'm only using 2016,2017)
* \textcolor{Plum}{Genre} Genre of the game
* \textcolor{Plum}{Publisher} creator company name
* \textcolor{Plum}{Global Sales} Total worldwide sales (in millions)  

First we want to see the genre of the games.

```{r, echo=FALSE}

levels(droplevels(data1$Genre))
barplot(table(droplevels(data1$Genre)), ylab = "Number of Games",
     main = "How many games in each genre", col = "brown1", las=2, cex.names = 0.6, ylim =c(0,120))
title(xlab = "Genres", line=4)
```

As shown above "Action" and "Role Playing" and "Sports" are the top three genres.


The next column is the publishers.

As shown below, The top 5 company that released the most games in 2016 and 2017 are "Namco Bandai Games", "Electronic Arts", "Square Enix", "Capcom", "Tecmo Koei".  

Company Name | Games Released
------------ | --------------
Namco Bandai Games | 40
Electronic Arts | 20
Square Enix | 20
Capcom | 18
Tecmo Koei | 17


```{r, echo=FALSE}
barplot(table(droplevels(data1$Publisher)), las = 2, col = "blue3", ylab = "number of games", main = "Number of game each company released in two years", cex.names = 0.5)

```
  
  
The platforms are the games are :

```{r, echo=FALSE}

levels(droplevels(data1$Platform))  


barplot(table(droplevels(data1$Platform)), ylim = c(0,120), ylab = "Number of Games", xlab = "The Platfroms", main = "Platform of the games in 2016 and 2017", col = "dodgerblue")
```

The most game created in 2016 and 2017 were for PS4, after that is PSV and xbox One.  

The last column is the Global Sales rate.  


```{r, echo=FALSE}
summary(data1$Global_Sales)  


hist(data1$Global_Sales, main = "Histogram of the global sales", xlab = "Global Sales", col = "darkolivegreen1", ylim = c(0,350), las = 1)

```


Most of the sales are between 0 to 1 milions. However we see that one game has sold near 5 millions in the world


## \textcolor{blue}{Research Question}  

First, I want to examine the effect of genre in global sales rate.

Using the global sale number as the response, I performed a **\textcolor{BrickRed}{one-way Anova}** to determine whether genre have significant effect on global sales.

First, The global F-test is used to test whether there is a difference in global sales mean between each groups or not.


\textcolor{WildStrawberry}{1. Set up the hypothesis}

\textcolor{Fuchsia}{$h_0: \mu_1=\mu_2=...=\mu_{11}$} all underlying means are equal

\textcolor{Fuchsia}{$h_1: \mu_i\neq\mu_j$ for some i and j} (At least two of the underlying population means are different)


\textcolor{WildStrawberry}{2. Select the appropriate test statistic}

\textcolor{Fuchsia}{$F = \frac{MSB}{MSW}$} with k-1=10 and n-k=347-11=336 degrees of freedom

\textcolor{WildStrawberry}{3. State the decision Rule}

F-distribution with 10 and 336 degrees of freedom and associated with $\alpha = 0.5$

```{r}
qf(0.95, df1=10, df2=336)

```
Decision Rule : Reject H0 if $F \geq 1.858$  
otherwise, do not reject H0.

\textcolor{WildStrawberry}{4. Compute the test statistic}

```{r, echo=FALSE}

m <- aov(data1$Global_Sales~data1$Genre)
summary(m)
```

\textcolor{WildStrawberry}{5. Conclusion}

Reject H0, since there is a significant evidance that there is a difference in the mean global sales among different genres.  

```{r, echo=FALSE}
boxplot(data1$Global_Sales~data1$Genre, data=data1, main="Global Sales by Genre", ylab="Global Sales", col =rainbow(11), ylim = c(0,1), las=2, xlab = "Genre", cex.axis = 0.6)

```

The global F-test showed a significance difference between global sales mean across each genres. However, these differences might be affected by other factors such as, the name of the company that released the game and the platform of the game. Therefore, I like to perform an ANCOVA test to be sure the differences I saw in the global sales across each groups are not affected by the these other factors.

After adjusting for multiple comparisons using Tukeys methodology, the only pairwise comparisons that were significant were between  

Genres| p-adj
------| -----
Shooter-Action | 0.0010757
Shooter-Adventure | 0.0005833
Shooter-Misc | 0.0138969
Shooter-Racing | 0.0141107
Shooter-Role Playing | 0.0115817

```{r, echo=FALSE, include=FALSE}

TukeyHSD(m)
```




However, after adjusting for the publisher and the platform the results changed.   





```{r, echo=FALSE, warning=FALSE, tidy=TRUE}

library(car)
library(carData)
library(emmeans)
# install.packages("emmeans")
my.model<-lm(data1$Global_Sales~data1$Genre+data1$Publisher+data1$Platform)
Anova(my.model, type=3)
emm_options(contrasts=c("contr.treatment", "contr.poly"))
emmeans(my.model, specs = "Genre" , contr = "pairwise", adjust="tukey")

```




## \textcolor{blue}{R Code}

setwd("~/Desktop/Uni Courses/Spring 2020/CS555/Term Project")  

data <- read.csv("vgsales.csv")  

data1 <- subset(data, data\$Year == 2016 | data$Year == 2017, -c(1,7,8,10,9))  

data1 <- data1[-c(which(data1\$Publisher == "N/A" | data1$Publisher == "Unknown")),] 

write.table(data1, file = "data.csv",sep = "\\t", row.names = F)  

colnames(data1)  

levels(droplevels(data1$Genre))  

barplot(table(droplevels(data1$Genre)), ylab = "Number of Games",
        main = "How many games in each genre", col = "brown1", las=2, cex.names = 0.6, ylim =c(0,120))  
        
title(xlab = "Genres", line=4)  

barplot(table(droplevels(data1$Publisher)), las = 2, col = "blue3", ylab = "number of games", main = "Number of game each company released in two years", cex.names = 0.5)  


levels(droplevels(data1$Platform))   


barplot(table(droplevels(data1$Platform)), ylim = c(0,120), ylab = "Number of Games", xlab = "The Platfroms", main = "Platform of the games in 2016 and 2017", col = "dodgerblue")  

summary(data1$Global_Sales)  


hist(data1$Global_Sales, main = "Histogram of the global sales", xlab = "Global Sales", col = "darkolivegreen1", ylim = c(0,350), las = 1)  

qf(0.95, df1=10, df2=336)  

m <- aov(data1\$Global_Sales~data1$Genre)  

summary(m)  

boxplot(data1\$Global_Sales~data1$Genre, data=data1, main="Global Sales by Genre", ylab="Global Sales", col =rainbow(11), ylim = c(0,1), las=2, xlab = "Genre", cex.axis = 0.6)  

TukeyHSD(m)  

library(car)  

library(carData)  

library(emmeans)  

install.packages("emmeans")  

my.model<-lm(data1\$Global_Sales~data1\$Genre+data1\$Publisher+data1$Platform)  

Anova(my.model, type=3)  

emm_options(contrasts=c("contr.treatment", "contr.poly"))  

emmeans(my.model, specs = "Genre" , contr = "pairwise", adjust="tukey")  




## \textcolor{blue}{Conclusion}

The Genre of a game do play a significant role in determining the global sale of a game. But it's not just the genre that change how popular and successfull a game can be in the world.At first, the global F-test showed there was a significant difference between the sales mean of each genre. However, after adjusting for the platform and the publisher,it became clear that the differences in the sales mean were the result of differences in these factors, There were significant evidance for difference in three major genres.


Genres| p-adj
------| -----
Shooter-Action | 0.0017
Action-Sports | 0.0144



